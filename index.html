<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Zineb Moon â€” Fire Comet Game</title>
<style>
  html, body { margin:0; padding:0; overflow:hidden; background:#000; height:100%; }
  canvas { display:block; }
  .hud { position:fixed; top:12px; left:12px; color:#eaf4ff; font-family:system-ui,sans-serif; z-index:10; }
</style>
</head>
<body>
<canvas id="space"></canvas>
<div class="hud">
  ðŸŒ• Zineb Moon Game<br/>
  Score: <span id="score">0</span><br/>
  Left: speed â€¢ Middle: pause â€¢ Right: reverse
</div>
<script>
const canvas=document.getElementById("space"), ctx=canvas.getContext("2d");
const scoreEl=document.getElementById("score");
function resize(){ canvas.width=innerWidth; canvas.height=innerHeight; }
window.addEventListener("resize",resize);
resize();

const Input={x:innerWidth/2,y:innerHeight/2,left:false,middle:false,right:false};
addEventListener("mousemove",e=>Input.x=e.clientX, false); addEventListener("mousemove",e=>Input.y=e.clientY,false);
addEventListener("mousedown",e=>{if(e.button==0)Input.left=true;if(e.button==1)Input.middle=true;if(e.button==2)Input.right=true;});
addEventListener("mouseup",e=>{if(e.button==0)Input.left=false;if(e.button==1)Input.middle=false;if(e.button==2)Input.right=false;});
addEventListener("contextmenu",e=>e.preventDefault());

let paused=false, reverse=false, pausedOnce=false, reversedOnce=false;
let score=0;

// ===== Moon =====
const moon={x:innerWidth*0.35, y:innerHeight*0.35, r:100, dx:0.25, dy:0.2, alive:true, craters:[]};
function seedCraters(){ moon.craters=[]; for(let i=0;i<20;i++){ const ang=Math.random()*2*Math.PI; const rad=Math.random()*moon.r*0.7; const cx=moon.x+Math.cos(ang)*rad; const cy=moon.y+Math.sin(ang)*rad; const rr=Math.random()*12+4; moon.craters.push({x:cx,y:cy,r:rr,a:Math.random()*0.4+0.2}); } }
seedCraters();

// ===== Explosion particles =====
let particles=[];

// ===== Stars =====
const stars=[]; for(let i=0;i<500;i++){ stars.push({x:Math.random()*innerWidth,y:Math.random()*innerHeight,r:Math.random()*1.5+0.5,a:Math.random(),tw:Math.random()*0.05+0.01,phase:Math.random()*Math.PI*2}); }

// ===== Comets =====
const cometColors=["#fff","#ffdd55","#a3c8ff","#ff8888","#fff38a"];
function makeComet(){ return {x:Math.random()*innerWidth,y:Math.random()*innerHeight,vx:(Math.random()-0.5)*2,vy:(Math.random()-0.5)*2,color:cometColors[Math.floor(Math.random()*cometColors.length)],trail:[],maxTrail:180,size:4+Math.random()*3}; }
const comets=Array.from({length:12},makeComet);

// ===== Game Functions =====
function explodeMoon(){
  moon.alive=false;
  particles.length=0;
  const N=250;
  for(let i=0;i<N;i++){
    const ang=Math.random()*2*Math.PI;
    const rad=(Math.random()**0.6)*moon.r;
    const px=moon.x+Math.cos(ang)*rad;
    const py=moon.y+Math.sin(ang)*rad;
    const spd=2+Math.random()*4;
    const hue=Math.random()<0.5?30+Math.random()*20:0;
    particles.push({x:px,y:py,vx:Math.cos(ang)*spd,vy:Math.sin(ang)*spd,life:1,size:2+Math.random()*4,hue:hue,gravity:0.02*Math.random()});
  }
  score++; scoreEl.textContent=score;
  setTimeout(respawnMoon,2500);
}
function respawnMoon(){ moon.r=100; moon.x=Math.random()*(innerWidth-2*moon.r)+moon.r; moon.y=Math.random()*(innerHeight-2*moon.r)+moon.r; moon.dx=(Math.random()*0.5+0.18)*(Math.random()<0.5?1:-1); moon.dy=(Math.random()*0.5+0.18)*(Math.random()<0.5?1:-1); moon.alive=true; seedCraters(); }

function update(dt){
  if(Input.middle && !pausedOnce){ paused=!paused; pausedOnce=true; } if(!Input.middle) pausedOnce=false;
  if(Input.right && !reversedOnce){ reverse=!reverse; reversedOnce=true; } if(!Input.right) reversedOnce=false;
  if(paused) return;

  // stars twinkle
  for(const s of stars){ s.phase+=dt*s.tw; s.a=0.25+0.5*(0.5+0.5*Math.sin(s.phase)); }

  // move moon
  if(moon.alive){ moon.x+=moon.dx; moon.y+=moon.dy; if(moon.x-moon.r<0||moon.x+moon.r>innerWidth)moon.dx*=-1; if(moon.y-moon.r<0||moon.y+moon.r>innerHeight)moon.dy*=-1; }

  // explosion
  for(const p of particles){ p.x+=p.vx; p.y+=p.vy; p.vx*=0.98; p.vy*=0.98; p.vy+=p.gravity; p.life-=dt*0.5; } particles=particles.filter(p=>p.life>0);

  // comets
  for(const c of comets){
    let speed=(Input.left?5:2.5)*(reverse?-1:1);
    const dx=Input.x-c.x,dy=Input.y-c.y,dist=Math.hypot(dx,dy)||1;
    c.vx+=(dx/dist)*0.12; c.vy+=(dy/dist)*0.12; c.vx*=0.94; c.vy*=0.94;
    c.x+=c.vx*speed; c.y+=c.vy*speed;
    if(c.x<-100)c.x=innerWidth+100; if(c.x>innerWidth+100)c.x=-100; if(c.y<-100)c.y=innerHeight+100; if(c.y>innerHeight+100)c.y=-100;
    c.trail.push({x:c.x,y:c.y}); if(c.trail.length>c.maxTrail)c.trail.shift();
    if(moon.alive){ const mdx=c.x-moon.x,mdy=c.y-moon.y; if(Math.hypot(mdx,mdy)<moon.r+c.size){ explodeMoon(); } }
  }
}

// ===== Draw =====
function draw(){
  ctx.fillStyle="#000"; ctx.fillRect(0,0,innerWidth,innerHeight);

  // stars
  for(const s of stars){ ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle=`rgba(255,255,255,${s.a})`; ctx.fill(); }

  // moon
  if(moon.alive){
    const grad=ctx.createRadialGradient(moon.x,moon.y,moon.r*0.1,moon.x,moon.y,moon.r);
    grad.addColorStop(0,"#fff"); grad.addColorStop(0.3,"#fffde0"); grad.addColorStop(0.6,"#fff5b3"); grad.addColorStop(1,"#a0a0a0");
    ctx.fillStyle=grad; ctx.beginPath(); ctx.arc(moon.x,moon.y,moon.r,0,2*Math.PI); ctx.fill();
    for(const c of moon.craters){ ctx.beginPath(); ctx.arc(c.x,c.y,c.r,0,2*Math.PI); ctx.fillStyle=`rgba(180,180,180,${c.a})`; ctx.fill(); }
    ctx.font=`bold ${moon.r*0.35}px system-ui`; ctx.fillStyle="rgba(30,30,30,0.9)"; ctx.textAlign="center"; ctx.textBaseline="middle"; ctx.fillText("Zineb",moon.x,moon.y);
  }

  // explosion
  for(const p of particles){ ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,2*Math.PI); ctx.fillStyle=`hsla(${p.hue},100%,55%,${p.life})`; ctx.fill(); }

  // comets
  for(const c of comets){
    for(let i=1;i<c.trail.length;i++){
      const p0=c.trail[i-1],p1=c.trail[i]; const a=i/c.trail.length;
      ctx.beginPath(); ctx.moveTo(p0.x,p0.y); ctx.lineTo(p1.x,p1.y);
      ctx.strokeStyle=`rgba(${hexToRgb(c.color)},${a*0.7})`; ctx.lineWidth=Math.max(1,c.size*(1-a)+0.5); ctx.stroke();
    }
    ctx.save(); ctx.shadowBlur=16; ctx.shadowColor=c.color; ctx.beginPath(); ctx.arc(c.x,c.y,c.size+0.5,0,2*Math.PI); ctx.fillStyle=c.color; ctx.fill(); ctx.restore();
  }
}

function hexToRgb(hex){const n=hex.replace('#','');const r=parseInt(n.slice(0,2),16);const g=parseInt(n.slice(2,4),16);const b=parseInt(n.slice(4,6),16);return r+','+g+','+b;}

let last=performance.now();
function loop(now){ const dt=(now-last)/1000; last=now; update(dt); draw(); requestAnimationFrame(loop);}
requestAnimationFrame(loop);
</script>
</body>
</html>
