<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ChatGPT — MVP Demo</title>
  <style>
    :root {
      --bg: #0b1020;
      --panel: #121830;
      --muted: #8a93ad;
      --text: #e8ecf4;
      --accent: #4f7cff;
      --accent-2: #22c55e;
      --danger: #ef4444;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; height: 100vh; background: radial-gradient(1200px 800px at 20% -10%, #182243, transparent), var(--bg);
      color: var(--text); font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Helvetica, Arial, sans-serif;
      display: grid; place-items: center; padding: 16px;
    }
    .app {
      width: min(900px, 100%);
      height: min(85vh, 880px);
      display: grid; grid-template-rows: auto 1fr auto; gap: 10px;
      background: linear-gradient(180deg, #141b34, #0f1530);
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: 20px; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.35);
    }
    .header {
      display: flex; align-items: center; gap: 12px; padding: 14px 16px; background: rgba(255,255,255,0.02);
      border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .logo { width: 28px; height: 28px; border-radius: 8px; background: conic-gradient(from 180deg at 50% 50%, var(--accent), #14b8a6, #a78bfa, var(--accent)); }
    .title { font-weight: 700; letter-spacing: 0.2px; }
    .subtitle { color: var(--muted); font-size: 12px; margin-left: auto; }

    .messages {
      padding: 16px; overflow: auto; display: flex; flex-direction: column; gap: 10px; scroll-behavior: smooth;
    }
    .msg {
      display: grid; grid-template-columns: 36px 1fr; gap: 10px; align-items: flex-start;
    }
    .msg .avatar {
      width: 36px; height: 36px; border-radius: 10px; display: grid; place-items: center; color: #fff; font-weight: 700;
    }
    .user .avatar { background: linear-gradient(135deg, #f59e0b, #ef4444); }
    .bot .avatar { background: linear-gradient(135deg, var(--accent), #14b8a6); }

    .bubble {
      background: #0d1430; border: 1px solid rgba(255,255,255,0.06); padding: 12px 14px; border-radius: 14px; box-shadow: inset 0 1px 0 rgba(255,255,255,0.03);
      max-width: 100%;
    }
    .user .bubble { background: #0f193a; border-color: rgba(79, 124, 255, 0.35); }
    .bot .bubble { background: #0e1b2e; }
    .meta { margin-top: 6px; color: var(--muted); font-size: 11px; }

    .input {
      display: grid; grid-template-columns: 1fr auto; gap: 8px; padding: 12px; background: rgba(255,255,255,0.02); border-top: 1px solid rgba(255,255,255,0.06);
    }
    textarea {
      width: 100%; resize: none; min-height: 48px; max-height: 140px; padding: 12px 14px; border-radius: 14px; border: 1px solid rgba(255,255,255,0.08);
      background: #0d1430; color: var(--text); outline: none;
    }
    .actions { display: flex; gap: 8px; }
    button {
      display: inline-flex; align-items: center; gap: 8px; height: 48px; padding: 0 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.08); background: #0d1430; color: var(--text);
      cursor: pointer; transition: transform 0.02s ease-in-out, opacity 0.2s; white-space: nowrap;
    }
    button.primary { background: linear-gradient(180deg, var(--accent), #3b5ed6); border-color: rgba(0,0,0,0.15); color: white; }
    button:active { transform: translateY(1px); }

    .typing { display: inline-flex; align-items: center; gap: 8px; color: var(--muted); }
    .dots { display: inline-flex; gap: 4px; }
    .dot { width: 6px; height: 6px; border-radius: 6px; background: var(--muted); opacity: 0.3; animation: pulse 1.2s infinite; }
    .dot:nth-child(2) { animation-delay: 0.2s }
    .dot:nth-child(3) { animation-delay: 0.4s }
    @keyframes pulse { 0%, 100% { opacity: 0.2; transform: translateY(0) } 50% { opacity: 1; transform: translateY(-2px) } }

    code, pre { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; }
    pre { background: #0b1229; padding: 10px; border-radius: 10px; overflow: auto; border: 1px solid rgba(255,255,255,0.06); }

    .bar { display: flex; gap: 8px; align-items: center; }
    .pill { font-size: 11px; color: var(--muted); border: 1px dashed rgba(255,255,255,0.15); padding: 6px 8px; border-radius: 999px; }
    .danger { color: #fecaca; border-color: rgba(239,68,68,.35); }

    @media (max-width: 600px) {
      .subtitle { display: none; }
      .app { height: 90vh }
    }
  </style>
</head>
<body>
  <div class="app" role="application" aria-label="ChatGPT MVP">
    <div class="header">
      <div class="logo" aria-hidden="true"></div>
      <div class="title">ChatGPT — MVP</div>
      <div class="subtitle">Minimum Viable Product: text chat, short context, canned intelligence</div>
    </div>

    <div id="messages" class="messages" aria-live="polite"></div>

    <form id="composer" class="input" autocomplete="off">
      <div class="bar">
        <span class="pill">Context: in-session only</span>
        <span class="pill">No browsing</span>
        <span class="pill danger">Mock AI (rules, not ML)</span>
      </div>
      <div style="grid-column: 1 / -1; display: contents"></div>
      <textarea id="prompt" placeholder="Ask anything… (e.g., Explain MVP in 2 lines)" aria-label="Your message"></textarea>
      <div class="actions">
        <button type="button" id="clear" title="Clear chat">Clear</button>
        <button class="primary" id="send" type="submit" title="Send">Send ▶</button>
      </div>
    </form>
  </div>

  <script>
    /**
     * ChatGPT MVP (frontend only):
     * - Short in-session context
     * - Simple rule-based responder (no network)
     * - Typing indicator
     * - Copyable, single-file demo
     */

    const els = {
      messages: document.getElementById('messages'),
      composer: document.getElementById('composer'),
      prompt: document.getElementById('prompt'),
      clear: document.getElementById('clear'),
      send: document.getElementById('send'),
    };

    const state = {
      history: [], // {role: 'user'|'assistant', content: string, ts: number}
      maxTurns: 20,
    };

    function now() { return new Date(); }
    function fmtTime(d) {
      return d.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
    }

    function addMessage(role, content) {
      const wrap = document.createElement('div');
      wrap.className = `msg ${role}`;
      wrap.innerHTML = `
        <div class="avatar" aria-hidden="true">${role === 'user' ? 'U' : 'G'}</div>
        <div class="bubble">
          <div class="content">${renderMarkdown(content)}</div>
          <div class="meta">${role === 'user' ? 'You' : 'Assistant'} • ${fmtTime(now())}</div>
        </div>`;
      els.messages.appendChild(wrap);
      els.messages.scrollTop = els.messages.scrollHeight;
      state.history.push({ role, content, ts: Date.now() });
      while (state.history.length > state.maxTurns * 2) state.history.shift();
    }

    function typingIndicator() {
      const wrap = document.createElement('div');
      wrap.className = 'msg bot';
      wrap.id = 'typing';
      wrap.innerHTML = `
        <div class="avatar">G</div>
        <div class="bubble">
          <span class="typing">Thinking <span class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span></span>
          <div class="meta">Assistant • ${fmtTime(now())}</div>
        </div>`;
      els.messages.appendChild(wrap);
      els.messages.scrollTop = els.messages.scrollHeight;
      return () => wrap.remove();
    }

    function renderMarkdown(text) {
      // ultra-light MD: code blocks ``` and inline `code`
      let html = text
        .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
      html = html.replace(/```([\s\S]*?)```/g, (m, p1) => `<pre><code>${p1}</code></pre>`);
      html = html.replace(/`([^`]+)`/g, '<code>$1</code>');
      html = html.replace(/\n/g, '<br/>');
      return html;
    }

    // --- Mock intelligence (MVP rules) ---
    function respond(userText) {
      const text = userText.trim();
      const lower = text.toLowerCase();
      const history = state.history.slice(-6); // short context window

      // 1) Greetings
      if (/^(hi|hello|hey)\b/.test(lower)) {
        return `Hey! I'm a *mock* ChatGPT MVP. Ask me anything and I'll try to help in a concise way.`;
      }
      // 2) Who/what are you
      if (/(who|what) are you|your (name|model)/.test(lower)) {
        return `I'm a minimalist demo: text in → text out. No internet, no plugins, short memory. Great for quick drafts and answers.`;
      }
      // 3) Explain X in N words/lines
      const explainMatch = lower.match(/explain (.+?) in (\d+) (word|words|line|lines)/);
      if (explainMatch) {
        const topic = explainMatch[1];
        const n = Math.min(10, parseInt(explainMatch[2], 10) || 2);
        return Array.from({length: n}, (_, i) => `${i+1}. ${titleCase(topic)} — key point ${i+1}.`).join('\n');
      }
      // 4) Summarize
      if (/^summari[sz]e\b/.test(lower)) {
        const lastUser = [...history].reverse().find(m => m.role === 'user' && m.content !== userText);
        return lastUser ? `TL;DR: ${lastUser.content.slice(0, 140)}…` : `Give me text to summarize.`;
      }
      // 5) Code request
      if (/\b(code|script|function)\b/.test(lower)) {
        return `Here's a tiny example:\n\n\u0060\u0060\u0060js\nfunction hello(name){ return ` + "`Hello, ${name}!`" + ` }\nconsole.log(hello('world'));\n\u0060\u0060\u0060`;
      }
      // 6) MVP definition
      if (/\bmvp\b/.test(lower)) {
        return `**MVP** = Minimum Viable Product: smallest set of features that solves the core problem for early adopters, so you can learn fast with minimal build.`;
      }
      // 7) Light contextual echo
      if (history.length) {
        const prev = history.filter(m => m.role === 'user').map(m => m.content).pop() || '';
        if (prev && prev !== userText && prev.split(' ').length < 16) {
          return `About *${prev}*: ${generateGeneralAnswer(text)}`;
        }
      }
      // 8) Generic helpful fallback
      return generateGeneralAnswer(text);
    }

    function generateGeneralAnswer(text) {
      const tips = [
        `Here are the essentials in bullets:`,
        `Let me outline a simple plan:`,
        `Key steps you can try:`,
        `In short:`,
      ];
      const plan = `\n- Clarify goal\n- Draft a first version\n- Test with a user\n- Iterate based on feedback`;
      return `${randomItem(tips)}\n${plan}\n\nYou asked: \`${text}\`. (Remember: this MVP demo uses simple rules.)`;
    }

    function randomItem(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
    function titleCase(s){ return s.replace(/\w\S*/g, t => t[0].toUpperCase() + t.slice(1)); }

    // --- Events ---
    els.composer.addEventListener('submit', (e) => {
      e.preventDefault();
      const text = els.prompt.value.trim();
      if (!text) return;
      els.prompt.value = '';
      addMessage('user', text);

      const stopTyping = typingIndicator();
      const latency = 300 + Math.min(1600, Math.round(text.length * 12));
      setTimeout(() => {
        const reply = respond(text);
        stopTyping();
        addMessage('bot', reply);
      }, latency);
    });

    els.clear.addEventListener('click', () => {
      state.history = [];
      els.messages.innerHTML = '';
      addMessage('bot', 'New chat started. I only remember this session. Ask me anything!');
      els.prompt.focus();
    });

    // Warm start
    addMessage('bot', 'Welcome to the ChatGPT MVP demo. Type a question and press **Send** or **Enter**.');

    // Auto-resize textarea
    els.prompt.addEventListener('input', () => {
      els.prompt.style.height = 'auto';
      els.prompt.style.height = Math.min(140, els.prompt.scrollHeight) + 'px';
    });
    // Submit on Enter (without Shift)
    els.prompt.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        els.send.click();
      }
    });
  </script>
</body>
</html>

